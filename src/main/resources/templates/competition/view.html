<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments.html :: head"></head>
<body class="d-flex flex-column min-vh-100 bg-light">
<div th:replace="fragments.html :: navigation-bar"></div>
<div class="container">
    <div th:replace="fragments.html :: competition-info"></div>
    <div th:replace="fragments.html :: competition-menu (currentMenu='matches')"></div>
    <div class="row justify-content-center">
        <div class="col-lg-10 py-3" th:if="${#strings.equals(type, 'LEAGUE')}">
            <div th:if="${matches.getTotalElements() == 0}" class="col">
                경기가 없습니다.
            </div>
            <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3" th:if="${matches.getTotalElements() > 0}">
                <div class="col mb-4" th:each="match: ${matches.getContent()}">
                    <a th:href="@{'/rooms/' + ${room.id} + '/competitions/' + ${competition.id} + '/matches/' + ${match.id}}" class="text-decoration-none">
                        <div class="card">
                            <div th:replace="fragments.html :: match"></div>
                        </div>
                    </a>
                </div>
            </div>
            <div th:replace="fragments.html :: page (pages=${matches}, url='/rooms/' + ${room.id} + '/competitions/' + ${competition.id})"></div>
        </div>

        <div class="col-lg-10 tournament-bracket tournament-bracket--rounded" th:if="${#strings.equals(type, 'TOURNAMENT')}">
            <div class="tournament-bracket__round" th:classappend="'tournament-bracket__round--' + ${#numbers.formatInteger(cnt, 0)}" th:each="key : ${#numbers.sequence(T(java.util.Collections).max(matches.keySet()), 0, -1)}"
                 th:with="cnt=${T(java.lang.Math).pow(2, key)}">
                <h3 class="tournament-bracket__round-title" th:text="${key == 0} ? '결승' : (${key == 1} ? '준결승' : (${key == 2} ? '8강' : (${key == 3} ? '16강' : (${key == 4} ? '32강' : '64강'))))"></h3>
                <ul class="tournament-bracket__list">
                    <li class="tournament-bracket__item" th:each="k : ${#numbers.sequence(0, cnt - 1, 1)}" th:with="match=${matches.get(key).get(k)}"
                        th:onclick="${match != null} ? |location.href='@{|/rooms/${room.id}/competitions/${competition.id}/matches/${match.id}|}'|" th:classappend="${match == null} ? 'my-hidden'">
                        <div class="tournament-bracket__match" tabindex="0">
                            <div th:replace="fragments.html :: match"></div>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div> <!-- /container -->
<div th:replace="fragments.html :: footer"></div>
<script th:replace="fragments.html :: date-time"></script>
<script th:replace="fragments.html :: tooltip"></script>
</body>
</html>